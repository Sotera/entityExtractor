redis:
  image: sotera/redis-watchman:1
  hostname: redis
  ports:
    - "6379:6379"

web:
  extends:
    file: common.yml
    service: loopback
  hostname: watchman
  links:
    - redis
    - mitie
  volumes_from:
    - data-container
  ports:
    - "8701:8701"
    - "3001:3001"

feed:
  extends:
    file: common.yml
    service: loopback
  hostname: feeds
  links:
    - redis
    - mitie
  volumes_from:
    - data-container
  ports:
    - "8702:8701"

queue:
  extends:
    file: common.yml
    service: loopback
  hostname: queue
  links:
    - redis
  volumes_from:
    - data-container
  ports:
    - "8703:8701"

event-finder:
  extends:
    file: common.yml
    service: loopback
  hostname: event-finder
  links:
    - redis
  volumes_from:
    - data-container
  ports:
    - "8704:8701"

mitie:
  image: lukewendling/mitie-server
  hostname: mitie
  ports:
    - "8888:8888"

trained-models:
  image: sotera/trained-models:1
  hostname: trained-models

embed-map:
  image: lukewendling/embed-map:2
  hostname: embed-map
  expose:
    - "3000"
  ports:
    - "3005:3000"

dr-manhattan:
  extends:
    file: common.yml
    service: analytic
  image: sotera/dr-manhattan:18
  hostname: dr-manhattan
  links:
    - redis

text-featurizer:
  extends:
    file: common.yml
    service: analytic
  image: sotera/rorschach:8
  hostname: text-featurizer
  links:
    - redis

hashtag-clusterer:
  extends:
    file: common.yml
    service: analytic
  image: sotera/comedian:18
  hostname: hashtag-clusterer
  environment:
    - TRUNCATE_POSTS=1
  links:
    - redis

cluster-linker:
  extends:
    file: common.yml
    service: analytic
  image: sotera/ozymandias:5
  hostname: cluster-linker
  links:
    - redis

feature-sim:
  extends:
    file: common.yml
    service: analytic
  image: sotera/feature-sim:10
  hostname: feature-sim
  environment:
    - TRUNCATE_POSTS=1
  links:
    - redis

image-fetcher:
  extends:
    file: common.yml
    service: analytic
  image: sotera/image-fetcher:5
  hostname: image-fetcher
  links:
    - redis
  volumes_from:
    - data-container

caffe:
  extends:
    file: common.yml
    service: analytic
  image: sotera/caffe_redis_client:17
  hostname: caffe
  links:
    - redis
  volumes_from:
    - data-container

aggregate-clustering:
  extends:
    file: common.yml
    service: analytic
  image: sotera/aggregate-clustering:6
  hostname: aggregate-clustering
  links:
    - redis
